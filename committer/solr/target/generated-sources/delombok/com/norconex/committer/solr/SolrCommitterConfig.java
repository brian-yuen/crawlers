// Generated by delombok at Fri Mar 08 16:24:17 MST 2024
/* Copyright 2019-2023 Norconex Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.norconex.committer.solr;

import java.util.Collections;
import java.util.HashMap;
import java.util.Map;
import java.util.Set;
import com.fasterxml.jackson.annotation.JsonIgnore;
import com.norconex.committer.core.batch.BaseBatchCommitterConfig;
import com.norconex.commons.lang.collection.CollectionUtil;
import com.norconex.commons.lang.security.Credentials;
import com.norconex.commons.lang.time.DurationParser;

/**
 * <p>
 * Commits documents to Apache Solr.
 * </p>
 *
 * <h3>Solr Client:</h3>
 * <p>
 * You can specify which type of
 * <a href="https://lucene.apache.org/solr/guide/8_1/using-solrj.html#types-of-solrclients">
 * Solr Client</a> to use.
 * The expected configuration value of "solrURL" is influenced
 * by the client type chosen.  Default client type is
 * <code>Http2SolrClient</code>. The clients are:
 * </p>
 * <dl>
 *   <dt>Http2SolrClient</dt>
 *     <dd>Default client. For direct access to a single Solr node. Ideal for
 *         local development or small setups. Expects a Solr URL.</dd>
 *   <dt>CloudSolrClient</dt>
 *     <dd>For use with a SolrCloud cluster. Expects a comma-separated list
 *         of Zookeeper hosts.</dd>
 *   <dt>LBHttp2SolrClient</dt>
 *     <dd>Simple load-balancing as an alternative to an external load balancer.
 *         Expects two or more Solr node URLs (comma-separated).</dd>
 *   <dt>ConcurrentUpdateHttp2SolrClient</dt>
 *     <dd>Optimized for mass upload on a single node.  Not best for queries.
 *         Expects a Solr URL.</dd>
 * </dl>
 *
 * <p>
 * The above client types are using the HTTP/2 protocol. They should be
 * favored over the following, which are using HTTP/1.x and are
 * considered <b>deprecated</b>:
 * </p>
 *
 * <dl>
 *   <dt>HttpSolrClient</dt>
 *     <dd>For direct access to a single Solr node. Ideal for
 *         local development. Expects a Solr URL.</dd>
 *   <dt>LBHttpSolrClient</dt>
 *     <dd>Simple load-balancing as an alternative to an external load balancer.
 *         Expects two or more Solr node URLs (comma-separated).</dd>
 *   <dt>ConcurrentUpdateSolrClient</dt>
 *     <dd>Optimized for mass upload on a single node.  Not best for queries.
 *         Expects a Solr URL.</dd>
 * </dl>
 *
 * <h3>Authentication</h3>
 * <p>
 * Basic authentication is supported for password-protected
 * Solr installations.
 * </p>
 *
 * {@nx.include com.norconex.commons.lang.security.Credentials#doc}
 *
 * {@nx.include com.norconex.committer.core.AbstractCommitter#restrictTo}
 *
 * {@nx.include com.norconex.committer.core.AbstractCommitter#fieldMappings}
 *
 * {@nx.xml.usage
 * <committer class="com.norconex.committer.solr.SolrCommitter">
 *   <solrClientType>
 *     (See class documentation for options. Default: HttpSolrClient.)
 *   </solrClientType>
 *   <solrURL>(URL to Solr)</solrURL>
 *   <solrUpdateURLParams>
 *     <param name="(parameter name)">(parameter value)</param>
 *     <!-- multiple param tags allowed -->
 *   </solrUpdateURLParams>
 *   <solrCommitDisabled>[false|true]</solrCommitDisabled>
 *
 *   <!-- Use the following if authentication is required. -->
 *   <credentials>
 *     {@nx.include com.norconex.commons.lang.security.Credentials@nx.xml.usage}
 *   </credentials>
 *
 *   <sourceIdField>
 *     (Optional document field name containing the value that will be stored
 *     in Solr target ID field. Default is the document reference.)
 *   </sourceIdField>
 *   <targetIdField>
 *     (Optional name of Solr field where to store a document unique
 *     identifier (sourceIdField).  If not specified, default is "id".)
 *   </targetIdField>
 *   <targetContentField>
 *     (Optional Solr field name to store document content/body.
 *     Default is "content".)
 *   </targetContentField>
 *
 *   {@nx.include com.norconex.committer.core.batch.AbstractBatchCommitter#options}
 * </committer>
 * }
 *
 * <p>
 * XML configuration entries expecting millisecond durations
 * can be provided in human-readable format (English only), as per
 * {@link DurationParser} (e.g., "5 minutes and 30 seconds" or "5m30s").
 * </p>
 */
@SuppressWarnings("javadoc")
public class SolrCommitterConfig extends BaseBatchCommitterConfig {
    /**
     * Default Solr ID field
     */
    public static final String DEFAULT_SOLR_ID_FIELD = "id";
    /**
     * Default Solr content field
     */
    public static final String DEFAULT_SOLR_CONTENT_FIELD = "content";
    /**
     * The type of Solr client.
     */
    private SolrClientType solrClientType;
    /**
     * The endpoint URL used to connect to Solr (as per the client type
     * selected).
     */
    private String solrURL;
    /**
     * Whether to send an explicit commit request at the end of every
     * batch, or let the server auto-commit.
     */
    private boolean solrCommitDisabled;
    private final Map<String, String> updateUrlParams = new HashMap<>();
    private final Credentials credentials = new Credentials();
    /**
     * The document field name containing the value to be stored
     * in Solr ID field. A <code>null</code> value (default) will use the
     * document reference instead of a document field.
     */
    private String sourceIdField;
    /**
     * The name of the Solr field where to store a document unique
     * identifier (sourceIdField).  Default is "id".
     */
    private String targetIdField = DEFAULT_SOLR_ID_FIELD;
    /**
     * The name of the Solr field where content will be stored. Default
     * is "content". A <code>null</code> value will disable storing the content.
     */
    private String targetContentField = DEFAULT_SOLR_CONTENT_FIELD;

    /**
     * Gets URL parameters to be added on Solr HTTP calls.
     * @return a map of parameter names and values
     */
    public Map<String, String> getUpdateUrlParams() {
        return Collections.unmodifiableMap(updateUrlParams);
    }

    /**
     * Sets URL parameters to be added on Solr HTTP calls.
     * @param updateUrlParams a map of parameter names and values
     */
    public void setUpdateUrlParams(Map<String, String> updateUrlParams) {
        CollectionUtil.setAll(this.updateUrlParams, updateUrlParams);
    }

    /**
     * Sets a URL parameter to be added on Solr HTTP calls.
     * @param name parameter name
     * @param value parameter value
     */
    public void setUpdateUrlParam(String name, String value) {
        updateUrlParams.put(name, value);
    }

    /**
     * Gets a URL parameter value by its parameter name.
     * @param name parameter name
     * @return parameter value
     */
    public String getUpdateUrlParam(String name) {
        return updateUrlParams.get(name);
    }

    /**
     * Gets the update URL parameter names.
     * @return parameter names
     */
    @JsonIgnore
    public Set<String> getUpdateUrlParamNames() {
        return updateUrlParams.keySet();
    }

    /**
     * Gets Solr authentication credentials.
     * @return credentials
     */
    public Credentials getCredentials() {
        return credentials;
    }

    /**
     * Sets Solr authentication credentials.
     * @param credentials the credentials
     */
    public void setCredentials(Credentials credentials) {
        this.credentials.copyFrom(credentials);
    }

    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    public SolrCommitterConfig() {
    }

    /**
     * The type of Solr client.
     * @return Solr client type
     */
    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    public SolrClientType getSolrClientType() {
        return this.solrClientType;
    }

    /**
     * The endpoint URL used to connect to Solr (as per the client type
     * selected).
     * @return Solr URL
     */
    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    public String getSolrURL() {
        return this.solrURL;
    }

    /**
     * Whether to send an explicit commit request at the end of every
     * batch, or let the server auto-commit.
     * @return <code>true</code> if disabling sending Solr commits.
     */
    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    public boolean isSolrCommitDisabled() {
        return this.solrCommitDisabled;
    }

    /**
     * The document field name containing the value to be stored
     * in Solr ID field. A <code>null</code> value (default) will use the
     * document reference instead of a document field.
     * @return name of field containing id value
     */
    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    public String getSourceIdField() {
        return this.sourceIdField;
    }

    /**
     * The name of the Solr field where to store a document unique
     * identifier (sourceIdField).  Default is "id".
     * @return name of Solr ID field
     */
    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    public String getTargetIdField() {
        return this.targetIdField;
    }

    /**
     * The name of the Solr field where content will be stored. Default
     * is "content". A <code>null</code> value will disable storing the content.
     * @return target content field name
     */
    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    public String getTargetContentField() {
        return this.targetContentField;
    }

    /**
     * The type of Solr client.
     * @param solrClientType solr client type
     * @return {@code this}.
     */
    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    public SolrCommitterConfig setSolrClientType(final SolrClientType solrClientType) {
        this.solrClientType = solrClientType;
        return this;
    }

    /**
     * The endpoint URL used to connect to Solr (as per the client type
     * selected).
     * @param solrURL solrURL
     * @return {@code this}.
     */
    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    public SolrCommitterConfig setSolrURL(final String solrURL) {
        this.solrURL = solrURL;
        return this;
    }

    /**
     * Whether to send an explicit commit request at the end of every
     * batch, or let the server auto-commit.
     * @param solrCommitDisabled <code>true</code> if sending Solr commit is
     *        disabled
     * @return {@code this}.
     */
    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    public SolrCommitterConfig setSolrCommitDisabled(final boolean solrCommitDisabled) {
        this.solrCommitDisabled = solrCommitDisabled;
        return this;
    }

    /**
     * The document field name containing the value to be stored
     * in Solr ID field. A <code>null</code> value (default) will use the
     * document reference instead of a document field.
     * @param sourceIdField name of field containing id value,
     *        or <code>null</code>
     * @return {@code this}.
     */
    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    public SolrCommitterConfig setSourceIdField(final String sourceIdField) {
        this.sourceIdField = sourceIdField;
        return this;
    }

    /**
     * The name of the Solr field where to store a document unique
     * identifier (sourceIdField).  Default is "id".
     * @param targetIdField name of Solr ID field
     * @return {@code this}.
     */
    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    public SolrCommitterConfig setTargetIdField(final String targetIdField) {
        this.targetIdField = targetIdField;
        return this;
    }

    /**
     * The name of the Solr field where content will be stored. Default
     * is "content". A <code>null</code> value will disable storing the content.
     * @param targetContentField target content field name
     * @return {@code this}.
     */
    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    public SolrCommitterConfig setTargetContentField(final String targetContentField) {
        this.targetContentField = targetContentField;
        return this;
    }

    @java.lang.Override
    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    public boolean equals(final java.lang.Object o) {
        if (o == this) return true;
        if (!(o instanceof SolrCommitterConfig)) return false;
        final SolrCommitterConfig other = (SolrCommitterConfig) o;
        if (!other.canEqual((java.lang.Object) this)) return false;
        if (!super.equals(o)) return false;
        if (this.isSolrCommitDisabled() != other.isSolrCommitDisabled()) return false;
        final java.lang.Object this$solrClientType = this.getSolrClientType();
        final java.lang.Object other$solrClientType = other.getSolrClientType();
        if (this$solrClientType == null ? other$solrClientType != null : !this$solrClientType.equals(other$solrClientType)) return false;
        final java.lang.Object this$solrURL = this.getSolrURL();
        final java.lang.Object other$solrURL = other.getSolrURL();
        if (this$solrURL == null ? other$solrURL != null : !this$solrURL.equals(other$solrURL)) return false;
        final java.lang.Object this$updateUrlParams = this.getUpdateUrlParams();
        final java.lang.Object other$updateUrlParams = other.getUpdateUrlParams();
        if (this$updateUrlParams == null ? other$updateUrlParams != null : !this$updateUrlParams.equals(other$updateUrlParams)) return false;
        final java.lang.Object this$credentials = this.getCredentials();
        final java.lang.Object other$credentials = other.getCredentials();
        if (this$credentials == null ? other$credentials != null : !this$credentials.equals(other$credentials)) return false;
        final java.lang.Object this$sourceIdField = this.getSourceIdField();
        final java.lang.Object other$sourceIdField = other.getSourceIdField();
        if (this$sourceIdField == null ? other$sourceIdField != null : !this$sourceIdField.equals(other$sourceIdField)) return false;
        final java.lang.Object this$targetIdField = this.getTargetIdField();
        final java.lang.Object other$targetIdField = other.getTargetIdField();
        if (this$targetIdField == null ? other$targetIdField != null : !this$targetIdField.equals(other$targetIdField)) return false;
        final java.lang.Object this$targetContentField = this.getTargetContentField();
        final java.lang.Object other$targetContentField = other.getTargetContentField();
        if (this$targetContentField == null ? other$targetContentField != null : !this$targetContentField.equals(other$targetContentField)) return false;
        return true;
    }

    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    protected boolean canEqual(final java.lang.Object other) {
        return other instanceof SolrCommitterConfig;
    }

    @java.lang.Override
    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    public int hashCode() {
        final int PRIME = 59;
        int result = super.hashCode();
        result = result * PRIME + (this.isSolrCommitDisabled() ? 79 : 97);
        final java.lang.Object $solrClientType = this.getSolrClientType();
        result = result * PRIME + ($solrClientType == null ? 43 : $solrClientType.hashCode());
        final java.lang.Object $solrURL = this.getSolrURL();
        result = result * PRIME + ($solrURL == null ? 43 : $solrURL.hashCode());
        final java.lang.Object $updateUrlParams = this.getUpdateUrlParams();
        result = result * PRIME + ($updateUrlParams == null ? 43 : $updateUrlParams.hashCode());
        final java.lang.Object $credentials = this.getCredentials();
        result = result * PRIME + ($credentials == null ? 43 : $credentials.hashCode());
        final java.lang.Object $sourceIdField = this.getSourceIdField();
        result = result * PRIME + ($sourceIdField == null ? 43 : $sourceIdField.hashCode());
        final java.lang.Object $targetIdField = this.getTargetIdField();
        result = result * PRIME + ($targetIdField == null ? 43 : $targetIdField.hashCode());
        final java.lang.Object $targetContentField = this.getTargetContentField();
        result = result * PRIME + ($targetContentField == null ? 43 : $targetContentField.hashCode());
        return result;
    }

    @java.lang.Override
    @java.lang.SuppressWarnings("all")
    @lombok.Generated
    public java.lang.String toString() {
        return "SolrCommitterConfig(super=" + super.toString() + ", solrClientType=" + this.getSolrClientType() + ", solrURL=" + this.getSolrURL() + ", solrCommitDisabled=" + this.isSolrCommitDisabled() + ", updateUrlParams=" + this.getUpdateUrlParams() + ", credentials=" + this.getCredentials() + ", sourceIdField=" + this.getSourceIdField() + ", targetIdField=" + this.getTargetIdField() + ", targetContentField=" + this.getTargetContentField() + ")";
    }
}
